function Drag(a){this.json=a,this.plant=null,this.coor=null,this.div=null,this.rotate=null,this.check()}var _p=Drag.prototype;_p.check=function(){this.plant="object"==typeof this.json.plant?this.json.plant:$("body"),this.div="object"==typeof this.json.div?this.json.div:null,this.coor="string"==typeof this.json.coor?this.json.coor:null,this.rotate="string"==typeof this.json.rotate?this.json.rotate:null,this.createMove(),null!=this.div&&(null!=this.coor&&this.createCoor(),null!=this.rotate&&this.createRotate())},_p.createMove=function(){var a=this,b=this.plant.offset(),c=this.div;c.mousedown(function(a){var c=$(this).offset(),d={};d.x=a.pageX+b.left-c.left,d.y=a.pageY+b.top-c.top,this.posix={x:d.x,y:d.y},$.extend(document,{move:!0,move_target:this})}).mouseup(function(){a.removeDiv()})},_p.createCoor=function(){var a=this.div;a.on("mousedown",this.coor,function(b){var c={w:a.width(),h:a.height(),x:b.pageX,y:b.pageY};return $.extend(document,{move:!0,call_down:function(b){a.css({height:Math.max(30,b.pageY-c.y+c.h),width:Math.max(30,b.pageX-c.x+c.w)})}}),!1})},_p.createRotate=function(){var a=this.div;a.on("mousedown",this.rotate,function(b){var c=({w:a.width(),h:a.height(),x:b.pageX,y:b.pageY},a.offset().left+a.width()/2),d=a.offset().top+a.height()/2,e={x:c,y:d};return $.extend(document,{move:!0,call_down:function(b){var c={x:b.pageX,y:b.pageY},d=calculationRotation(e,c);d=5>=d||d>=355?0:d,a.css({transform:"rotate("+d+"deg)"})}}),!1})},_p.removeDiv=function(){var a=this.div;(a.css("left").split("px")[0]<-a.width()||a.css("right").split("px")[0]<-a.width()||a.css("top").split("px")[0]<-a.height()||a.css("bottom").split("px")[0]<-a.height())&&this._remove()},_p._remove=function(){var a=this.div;a.remove()};var calculationRotation=function(a,b){var c=a,d=b;if("undefined"!=typeof c&&"undefined"!=typeof d)var e=c.x-d.x,f=c.y-d.y;var g;if(e>0&&f>0){e=Math.abs(e),f=Math.abs(f);var h=Math.sqrt(e*e+f*f);g=90-Math.asin(e/h)/Math.PI*180+270}else if(0>e&&f>0){e=Math.abs(e),f=Math.abs(f);var h=Math.sqrt(e*e+f*f);g=Math.asin(e/h)/Math.PI*180}else if(0>e&&0>f){e=Math.abs(e),f=Math.abs(f);var h=Math.sqrt(e*e+f*f);g=90-Math.asin(e/h)/Math.PI*180+90}else{e=Math.abs(e),f=Math.abs(f);var h=Math.sqrt(e*e+f*f);g=Math.asin(e/h)/Math.PI*180+180}return Math.round(g)};$(function(){$(document).mousemove(function(a){if(this.move){var b=document.move_target?document.move_target.posix:{x:0,y:0},c=document.call_down||function(){$(this.move_target).css({top:a.pageY-b.y,left:a.pageX-b.x})};c.call(this,a,b)}}).mouseup(function(a){if(this.move){var b=document.call_up||function(){};b.call(this,a),$.extend(this,{move:!1,move_target:null,call_down:!1,call_up:!1})}})});